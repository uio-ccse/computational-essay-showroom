---
redirect_from:
  - "/essays/exercises/fallingthroughtheearth/fallingthroughtheearth"
interact_link: content/essays/exercises/FallingThroughTheEarth/FallingThroughTheEarth.ipynb
kernel_name: python3
kernel_path: content/essays/exercises/FallingThroughTheEarth
has_widgets: false
title: |-
  How long would it take to fall through the Earth?
pagenum: 13
prev_page:
  url: /exercisesets.html
next_page:
  url: /essays/exercises/FallingThroughTheEarth/FallingThroughTheEarth-Solution.html
suffix: .ipynb
search: earth uniform acceleration mass function exercise through density fall position center gravitational velocity different distance shell given datapoints euler cromer calculate gravity need m pull step frac r total results object b being radius define theorem non movement between objects arrays starting model distances inner outer take method inside force any takes into below much closer falling using lists loop c plot comment data graphs made core along f constant times second gives us above further parts problem our its earths raw githubusercontent com karlhenrik jupyter book showroom master content features activities fallingthroughtheearth jpg found sphere same uniformgravityaccel during why

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">How long would it take to fall through the Earth?</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="How-long-would-it-take-to-fall-through-the-Earth?">How long would it take to fall through the Earth?<a class="anchor-link" href="#How-long-would-it-take-to-fall-through-the-Earth?"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Learning-Objectives">Learning Objectives<a class="anchor-link" href="#Learning-Objectives"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The student will be able to:</p>
<ul>
<li>Apply the Shell-Theorem to find forces within a non-uniform body</li>
<li>Use the Euler-Cromer method to calculate movement under the effect of a varying gravity</li>
<li>Interpret plots of position/velocity/acceleration/mass and identify the connections between them<ul>
<li>Justify the different behaviour of graphs in terms of the chaning property of the Earth</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Gravity-inside-the-Earth">Gravity inside the Earth<a class="anchor-link" href="#Gravity-inside-the-Earth"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What would happen if the ground under you disappeared and you fell all the way to the center of the Earth? What if someone somehow made a tunnel from the surface to the core? How fast would you go along the way? How long would it take to fall all the way through?</p>
<p>To anwser these questions, you will need to understand the effects of gravity inside of the Earth.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1">#Used for mathematical functions and constants</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1">#Used for plotting</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Gravity">Gravity<a class="anchor-link" href="#Gravity"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The gravitational force between two objects is given by $F = \frac{GMm}{r^2}$</p>
<p>where G is the gravitational constant $6.68\times10^-11\frac{Nm^2}{kg^2}$, M is the mass of one of the objects, m is the mass of the other object and r is the distance between the objects. The force acts on both of the objects, and is pointed from one object to the other. Furthermore, Newtons second law gives us that:</p>
$$
\begin{align*}
F = ma \Rightarrow a = \frac{F}{m} = \frac{GMm}{r^2m} = \frac{GM}{r^2}
\end{align*}
$$<p>This means that the gravitational acceleration at any given time is dependant only on the mass of the object pulling on you, and your distance to it.</p>
<p><strong>EXCERCISE 1:</strong></p>
<p><strong>a)</strong>
Write the function <strong>gravAccel(totalmass, position)</strong> that takes the mass of the object exerting the gravitational force, and the position relative to it as parameters, and returns the resultant gravitational <strong>acceleration</strong>.</p>
<p><strong>b)</strong>
Make the function take the direction of the force into account. A positive position corresponds to being above the object, and a negative position corresponds to being below the object.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Shell-Theorem">The Shell Theorem<a class="anchor-link" href="#The-Shell-Theorem"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The main difference between being affected by gravity while outside the Earth, and being affected while inside it, is how much of it is below you to "pull you down". As you venture further down, less of the Earth will be below you to pull you down, and more of it will be above you to pull you up. In addition to this, as you get closer to different parts of the Earth, they will have a greater pull on you due to being closer to you.</p>
<p>If we assume the Earth is perfectly spherical, the sum of these effects are described by the <a href="http://hyperphysics.phy-astr.gsu.edu/hbase/Mechanics/sphshell2.html">Shell Theorem</a>, which makes this problem much simpler. The Shell Theorem has the following implications for our problem:</p>
<ul>
<li>A spherically symmetric body affects external objects gravitationally as though all of its mass were concentrated at a point at its centre</li>
<li>When at a distance r from the center, all mass at a greater distance than r can be ignored</li>
</ul>
<p>This means that we do not have to calculate the gravitational pull from all throughout the Earth, since we can act as if all of the Earth's mass is located in its center. We also only need to worry about the what is further in than the point you are currently at.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://raw.githubusercontent.com/KarlHenrik/Jupyter-Book-Showroom/master/content/features/activities/FallingThroughTheEarth/ShellTheorem.jpg" alt="Drawing" style="width: 70%;"/></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Falling-through-a-uniform-Earth">Falling through a uniform Earth<a class="anchor-link" href="#Falling-through-a-uniform-Earth"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To start with, assume that the Earth has a constant density (a uniform Earth). This will make the problem easier to solve, and will make for a good foundation for later, when you will look at falling through a non-uniform Earth.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Finding-gravitational-acceleration-inside-of-a-uniform-Earth">Finding gravitational acceleration inside of a uniform Earth<a class="anchor-link" href="#Finding-gravitational-acceleration-inside-of-a-uniform-Earth"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>EXERCISE 2:</strong></p>
<p>Find the Earth's total mass and radius online, and use this to calculate the density of a uniform Earth.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>EXERCISE 3:</strong></p>
<p>Using the density you found in the previous exercise, write the function <strong>sphereMass(distance)</strong> that takes the distance from the center of the Earth as an argument, and returns the mass of a sphere with that distance as radius, and with the same density as the uniform Earth. <em>(This sphere will be the equivelant of the red area in the figure above.)</em></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>EXERCISE 4:</strong></p>
<p>Using the <strong>gravAccel</strong> function, the <strong>sphereMass</strong> function, and the implications of the Shell Theorem, write the function <strong>uniformGravityAccel(position)</strong> that calculates the gravitational acceleration at any position relative to the center of a uniform Earth.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Calculating-the-fall-through-a-uniform-Earth">Calculating the fall through a uniform Earth<a class="anchor-link" href="#Calculating-the-fall-through-a-uniform-Earth"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To calculate the movement through a uniform Earth, you will need to define some paramaters and some lists or arrays to save your results in. Then you will need to use the Euler-Cromer method to calculate the movement step by step.</p>
<p>A quick refresher on the structure of the Euler-Cromer method:</p>

<pre><code>for i in range(n-1):
    acceleration[i] = function(arguments)
    velocity[i+1] = velocity[i] + acceleration[i] * dt
    position[i+1] = position[i] + velocity[i+1] * dt</code></pre>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Euler-Cromer-loop">The Euler-Cromer loop<a class="anchor-link" href="#The-Euler-Cromer-loop"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>EXERCISE 5:</strong></p>
<p><strong>a)</strong>
Define the lists or arrays that will hold the positions, velocities and accelerations at any given time during the fall. Use a time step of 1 second, and 5000 iterations in your loop.</p>
<p><strong>b)</strong>
Make the starting distance from the center equal to the radius of the Earth, and make the starting velocity 0 m/s.</p>
<p><strong>c)</strong>
Define a list or array that holds all of the different times.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>EXERCISE 6:</strong></p>
<p>Do the Euler-Cromer calculation of a fall through a uniform Earth with the initial conditions from exercise 5, and an acceleration given by the <strong>uniformGravityAccel</strong> function.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>EXERCISE 7:</strong></p>
<p>Plot your results from exercise 6 (position, velocity and acceleration as a function of time).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>EXERCISE 8:</strong></p>
<p><strong>a)</strong>
Find the time it takes to fall through the uniform Earth.</p>
<p><strong>b)</strong>
Find the maximum velocity along the way.</p>
<p><strong>c)</strong>
Comment on the results. Why do the graphs look the way they do? And specifically:</p>
<ul>
<li>Why are the plots for position and acceleration so similar? (look at acceleration as a function of position, and the properties of the derivative of sine waves)</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Falling-through-a-non-uniform-Earth">Falling through a non-uniform Earth<a class="anchor-link" href="#Falling-through-a-non-uniform-Earth"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So far you have looked at a fall through a uniform Earth, but the Earth is not uniform. The core, mantle and crust have very different densities, which changes the gravity during the fall and thus the nature of the fall significantly.</p>
<p>This figure shows how the different layers and densities of the Earth fit together.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://raw.githubusercontent.com/KarlHenrik/Jupyter-Book-Showroom/master/content/features/activities/FallingThroughTheEarth/RadialDensityPREM.jpg" alt="Drawing" style="width: 50%;"/></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>(taken from <a href="https://en.wikipedia.org/wiki/Structure_of_the_Earth">en.wikipedia.org/wiki/Structure_of_the_Earth</a>)</em></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Implementing-the--variable-density-of-the-Earth">Implementing the  variable density of the Earth<a class="anchor-link" href="#Implementing-the--variable-density-of-the-Earth"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Preliminary Reference Earth Model is a model which gives us the density of the Earth at different distances from the center.</p>
<p>The data can be found here: <a href="http://ds.iris.edu/ds/products/emc-prem/">http://ds.iris.edu/ds/products/emc-prem/</a> at "Model Download". I use the file "PREM_ANISOTROPIC".</p>
<p><strong>Make sure that you have the "PREM_ANISOTROPIC.txt" file in the same folder as the notebook file, or this won't work!</strong></p>
<p>Let us read the data and store them in arrays.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">radiusData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span>
<span class="n">densityData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1">#The file has 97 lines starting with &quot;[Radius] [Density]&quot; that are read like this</span>
<span class="n">infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;PREM_ANISOTROPIC.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">:]:</span> <span class="c1">#The data starts at line 3.</span>
    <span class="n">numbers</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">radiusData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">numbers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">densityData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">numbers</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radiusData</span><span class="o">/</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">),</span> <span class="n">densityData</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Density of the Earth as a function of distance from the center&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Distance from center [m * 10^6]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Density [kg/m^3]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../../images/essays/exercises/FallingThroughTheEarth/FallingThroughTheEarth_30_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Mass-at-different-heights">Mass at different heights<a class="anchor-link" href="#Mass-at-different-heights"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next you need the total mass further in than a given distance. By working our way from the center we can add one and one "shell" to find the total mass at different distances from the center. We have to find the total mass by adding these shells due to the relatively rough resolution of our density data.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://raw.githubusercontent.com/KarlHenrik/Jupyter-Book-Showroom/master/content/features/activities/FallingThroughTheEarth/EarthShells.jpg" alt="title"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that we use the same density for the inner and outer sphere to calculate the mass of the shell. The density we use for the spheres is the average of the Earth's density at the outer and inner radius of the shell. So that:</p>
$$ M_{shell} = M_{outer} - M_{inner} = \frac{4}{3}\pi r_{outer}^3 Density - \frac{4}{3}\pi r_{inner}^3 Density $$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">massData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">radiusData</span><span class="p">)):</span>
    <span class="n">shellDensity</span> <span class="o">=</span> <span class="p">(</span><span class="n">densityData</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">densityData</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="c1">#The average of the density at the outer and inner radius</span>
    <span class="c1">#Finding the mass of the shells corresponding to every data point</span>
    <span class="n">shellMass</span> <span class="o">=</span> <span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">radiusData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">shellDensity</span> <span class="o">-</span> <span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">radiusData</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">shellDensity</span>
    <span class="c1">#Adding the next total mass to the list, adding the mass of the current shell with the previous total mass</span>
    <span class="n">massData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">shellMass</span> <span class="o">+</span> <span class="n">massData</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The datapoints for density have now been turned into datapoints for total mass.</p>
<p><strong>EXERCISE 9:</strong>
Remove the "#" from the code below to see how the old model for the total mass at different distances from the center compares to the new one from the data. Comment on the result.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#plt.plot(radiusData/(10**6), [sphereMass(r)/(10**24) for r in radiusData])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radiusData</span><span class="o">/</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">),</span> <span class="n">massData</span><span class="o">/</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">24</span><span class="p">),</span> <span class="s2">&quot;ro&quot;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Total mass of the Earth at different distances from the center&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Distance from center [m * 10^6]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mass so far [kg * 10^24]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../../images/essays/exercises/FallingThroughTheEarth/FallingThroughTheEarth_37_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The next step is to turn the datapoints into datapoints for the gravitational acceleration.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="mf">6.674</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span> <span class="c1">#The gravitational constant</span>
<span class="n">accelData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">radiusData</span><span class="p">)):</span>
    <span class="n">accelData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">G</span><span class="o">*</span><span class="n">massData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">radiusData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The next step is to go from datapoints at discrete distances from the center, to a general function that gives the mass between the datapoints. This can be acheived by using the polyfit function. This function finds the polynomial of the given degree that best approximates the datapoints given.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy.polynomial.polynomial</span> <span class="k">as</span> <span class="nn">poly</span> <span class="c1">#Used later for finding a polynomial that approximates the data</span>

<span class="n">turn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">accelData</span><span class="p">)</span> <span class="c1">#The spike in the acceleration graph</span>
<span class="n">deg</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">coefs1</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">radiusData</span><span class="p">[:</span><span class="n">turn</span><span class="p">],</span> <span class="n">accelData</span><span class="p">[:</span><span class="n">turn</span><span class="p">],</span> <span class="n">deg</span><span class="p">)</span> <span class="c1">#Polynomial for the points further in than the &quot;spike&quot;</span>
<span class="n">coefs2</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">radiusData</span><span class="p">[</span><span class="n">turn</span><span class="p">:],</span> <span class="n">accelData</span><span class="p">[</span><span class="n">turn</span><span class="p">:],</span> <span class="n">deg</span><span class="p">)</span> <span class="c1">#Polynomial for the points further out than the &quot;spike&quot;</span>

<span class="n">earthRadius</span> <span class="o">=</span> <span class="n">radiusData</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">earthMass</span> <span class="o">=</span> <span class="n">massData</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">realGravityAccel</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="c1">#The absolute value of the distance</span>
    <span class="n">direc</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="c1">#The direction of gravity. It is opposite of our the sign of our position</span>

    <span class="k">if</span> <span class="n">dist</span> <span class="o">&gt;</span> <span class="n">earthRadius</span><span class="p">:</span> <span class="c1">#If we are outside the Earth</span>
        <span class="k">return</span><span class="p">(</span><span class="n">direc</span><span class="o">*</span><span class="n">G</span><span class="o">*</span><span class="n">earthMass</span><span class="o">/</span><span class="n">pos</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#Normal formula for acceleration using the mass of the entire Earth</span>

    <span class="k">elif</span> <span class="n">dist</span> <span class="o">&lt;</span> <span class="n">radiusData</span><span class="p">[</span><span class="n">turn</span><span class="p">]:</span> <span class="c1">#If we are further in than the &quot;spike&quot;</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">deg</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> <span class="c1">#a0 + a1*r + a2*r**2 + a3*r**3</span>
            <span class="nb">sum</span> <span class="o">+=</span> <span class="n">coefs1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">dist</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">direc</span><span class="o">*</span><span class="nb">sum</span><span class="p">)</span>
    
    <span class="k">else</span><span class="p">:</span> <span class="c1">#Function 2 for distances further out than the &quot;spike&quot;</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">deg</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="nb">sum</span> <span class="o">+=</span> <span class="n">coefs2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">dist</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">direc</span><span class="o">*</span><span class="nb">sum</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is a plot of the new function for gravity, together with the datapoints that made it.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radiusData</span><span class="o">/</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">),</span> <span class="p">[</span><span class="n">realGravityAccel</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">radiusData</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radiusData</span><span class="o">/</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">),</span> <span class="o">-</span><span class="n">accelData</span><span class="p">,</span> <span class="s2">&quot;ro&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Accelerations at different distances from the center&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Distance from center [m * 10^6]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Gravitational acceleration [m/s^2]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../../images/essays/exercises/FallingThroughTheEarth/FallingThroughTheEarth_43_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The red dots are the 97 discrete gravitational acceleration found using the datapoints from the PREM model. The blue line is a fourth degree polynomial that approximates these disctete points. The function <strong>realGravityAccel</strong> made the blue line, and is the function you will use later, instead of the <strong>uniGravityAccel</strong> function.</p>
<p>As you start falling, from the right of the graph, the acceleration will first stay nearly constant before increasing slightly until about 3000km. This is because, as you gets closer to the more dense inner parts of the Earth, the gravitational pull from them will increase. Since the outer layers are so much less dense than the mantle or core, you don't "lose" much gravitational pull compared to the pull you gain from being closer to the denser parts. When you are at around 3000 km, gravity starts weakening. This happens because the amount of mass pulling you down is starting to reduce fast.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Calculating-the-fall-through-a-non-uniform-Earth">Calculating the fall through a non-uniform Earth<a class="anchor-link" href="#Calculating-the-fall-through-a-non-uniform-Earth"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To calculate the movement through a non-uniform Earth, you will again need to define some paramaters and some lists or arrays to save your results in. Then you will need to use the Euler-Cromer method to calculate the movement step by step.</p>
<p>But before that, you need to take into account the variable density of the Earth.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>EXERCISE 10:</strong></p>
<p><strong>a)</strong>
Plot the <strong>realGravityAccel</strong> and <strong>uniformGravityAccel</strong> functions together, with distances from the center to the total radius of the Earth.</p>
<p><strong>b)</strong>
Comment on the results.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Euler-Cromer-loop">The Euler-Cromer loop<a class="anchor-link" href="#The-Euler-Cromer-loop"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>EXERCISE 11:</strong></p>
<p><strong>a)</strong>
Define the lists or arrays that will hold the positions, velocities and accelerations at any given time during the fall. Use a time step of 1 second, and 5000 iterations in your loop.</p>
<p><strong>b)</strong>
Make the starting distance from the center equal to the radius of the Earth, and make the starting velocity 0 m/s.</p>
<p><strong>c)</strong>
Define a list or array that holds all of the different times.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>EXERCISE 12:</strong></p>
<p>Do the Euler-Cromer calculation of a fall through a uniform Earth with the initial conditions from exercise 12, and an acceleration given by the <strong>realGravityAccel</strong> function.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>EXERCISE 13:</strong></p>
<p>Plot your results from exercise 12 (position, velocity and acceleration as a function of time).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>EXERCISE 14:</strong></p>
<p><strong>a)</strong>
Find the time it takes to fall through the uniform Earth.</p>
<p><strong>b)</strong>
Find the maximum velocity along the way.</p>
<p><strong>c)</strong>
Comment on the results. Why do the graphs look the way they do? And specifically:</p>
<ul>
<li>What effect does the shape of the acceleration graph have on the velocity graph?</li>
<li>What does a large acceleration lead to?</li>
<li>What does a changing acceleration lead to?</li>
</ul>

</div>
</div>
</div>
</div>

 


    </main>
    